<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Project Atomic</title>
  <subtitle>Tag: Rpm</subtitle>
  <id>http://www.projectatomic.io/blog/</id>
  <link href="http://www.projectatomic.io/blog/"/>
  <link href="http://www.projectatomic.io/blog/tag/rpm.xml" rel="self"/>
  <updated>2019-11-21T00:00:00+00:00</updated>
  <author>
    <name>Project Atomic. Sponsored by Red Hat, Inc.</name>
  </author>
  <entry>
    <title>Latest rpm-ostree features</title>
    <link rel="alternate" href="http://www.projectatomic.io/blog/2018/03/new-rpm-ostree-features/"/>
    <id>http://www.projectatomic.io/blog/2018/03/new-rpm-ostree-features/</id>
    <published>2018-03-20T17:00:00+00:00</published>
    <updated>2021-10-07T14:03:16+00:00</updated>
    <author>
      <name>Jonathan Lebon</name>
    </author>
    <content type="html">&lt;p&gt;&lt;a href="https://rpm-ostree.readthedocs.org/"&gt;rpm-ostree&lt;/a&gt; is the
hybrid image/package system that provides transactional
upgrades on Atomic Host.&lt;/p&gt;

&lt;p&gt;This blog post is a high-level summary of the recent
features that were added in the last few releases.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3&gt;New rojig delivery mechanism&lt;/h3&gt;

&lt;p&gt;By far the most fundamental shift that has occurred in the
latest releases is support for a different way of delivering
OSTrees to client machines. Dubbed &lt;q&gt;rojig&lt;/q&gt;, the idea is that
rather than clients downloading commits from OSTree remotes,
they instead re-assemble the exact same commit using RPMs
from yum repos. How? When OSTree commits are created on the
server, most of its files can be traced back to specific
RPMs. The work of figuring out which files come from which
RPM is done on the compose server. Files which do not come
from an RPM (e.g. the initramfs) are dumped in a special
&lt;q&gt;rojig RPM&lt;/q&gt;. Using this rojig RPM and all other constituent
RPMs, which are in essence fancy archives, the client is
capable of reproducing the bit-for-bit matching OSTree
commit.&lt;/p&gt;

&lt;p&gt;This allows content providers to only worry about delivering
RPMs, rather than yet another format. It opens the doors to
the many established tools and services that exist for
organizing and distributing RPMs.&lt;/p&gt;

&lt;p&gt;You can try this out today using the instructions in
&lt;a href="https://pagure.io/fedora-atomic-host-continuous/"&gt;FAHC&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;$ rpm-ostree status
State: idle; auto updates disabled
Deployments:
● ostree://fedora-atomic:fedora/27/x86_64/atomic-host
                   Version: 27.100 (2018-03-13 17:19:44)
                    Commit: 326f62b93a5cc836c97d31e73a71b6b6b6955c0f225f7651b52a693718e6aa91
              GPGSignature: Valid signature by 860E19B0AFA800A1751881A6F55E7430F5282EE4
$ cat &amp;gt;/etc/yum.repos.d/fahc.repo &amp;lt;&amp;lt;EOF
[fahc]
baseurl=https://ci.centos.org/artifacts/sig-atomic/fahc/jigdo
gpgcheck=0
EOF
$ rpm-ostree rebase --experimental rojig://fahc:fedora-atomic-host
...
Will download: 463 packages (349.5 MB)
  Downloading from updates: [=============] 100%
  Downloading from fedora: [=============] 100%
  Downloading from fahc: [=============] 100%
Importing (463/463) [=============] 100%
...
$ rpm-ostree status -v
State: idle; auto updates disabled
Deployments:
  fahc:fedora-atomic-host-27.406-1.fc27.x86_64
                   Version: 27.406 (2018-03-19 19:55:50)
                    Commit: 6495a62314ea2158240cba6a2cbb687bb6965a38d1c724ebdfaa63a13bf9ef73
                 StateRoot: fedora-atomic

● ostree://fedora-atomic:fedora/27/x86_64/atomic-host
                   Version: 27.100 (2018-03-13 17:19:44)
                    Commit: 326f62b93a5cc836c97d31e73a71b6b6b6955c0f225f7651b52a693718e6aa91
                 StateRoot: fedora-atomic
              GPGSignature: 1 signature
                            Signature made Tue 13 Mar 2018 05:19:53 PM UTC using RSA key ID F55E7430F5282EE4
                            Good signature from "Fedora 27 &amp;lt;fedora-27@fedoraproject.org&amp;gt;"
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;At no point in the above did we reach out to the
&lt;code&gt;fedora-atomic&lt;/code&gt; remote for data. Yet, we match the exact
same checksum:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;$ ostree remote summary fahc | grep -A2 fahc/27/x86_64/buildmaster
* fahc/27/x86_64/buildmaster
    Latest Commit (20.7 kB):
      6495a62314ea2158240cba6a2cbb687bb6965a38d1c724ebdfaa63a13bf9ef73
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is still a work in progress, though much of the
implementation has already been done. We&amp;rsquo;re hoping to drive
this as an experimental option in a future release of
Fedora.&lt;/p&gt;

&lt;p&gt;Upstream issue: &lt;a href="https://github.com/projectatomic/rpm-ostree/issues/1081"&gt;https://github.com/projectatomic/rpm-ostree/issues/1081&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;Automatic updates&lt;/h3&gt;

&lt;p&gt;Another major effort currently underway is a push for adding
support for automatic updates. As of the latest release,
rpm-ostree now supports a new &lt;code&gt;AutomaticUpdatePolicy&lt;/code&gt;
configuration option with only two possible values: &lt;code&gt;off&lt;/code&gt;
and &lt;code&gt;check&lt;/code&gt;. In &lt;code&gt;check&lt;/code&gt; mode, rpm-ostree will routinely
check the remote for updates and display any pending updates
in the output of &lt;code&gt;status&lt;/code&gt;:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;$ rpm-ostree status -v
State: idle; auto updates enabled (check; last run 56m ago)
Deployments:
● ostree://fedora:fedora/27/x86_64/workstation
                   Version: 27.94 (2018-03-16 16:33:28)
                    Commit: dc9d19682ca2414d5a76a9765a772d5f4d8f0d9768579ee434d742555168b40c
                 StateRoot: fedora
              GPGSignature: 1 signature
                            Signature made Fri 16 Mar 2018 12:33:36 PM EDT using RSA key ID F55E7430F5282EE4
                            Good signature from "Fedora 27 &amp;lt;fedora-27@fedoraproject.org&amp;gt;"

Available update:
        Version: 27.95 (2018-03-19 04:29:52)
         Commit: 6a99b39d701a243ec9668efe7511879df4697087869e913ec9f0a4d04fdffcb3
   GPGSignature: 1 signature
                 Signature made Mon 19 Mar 2018 12:30:00 AM EDT using RSA key ID F55E7430F5282EE4
                 Good signature from "Fedora 27 &amp;lt;fedora-27@fedoraproject.org&amp;gt;"
  SecAdvisories: FEDORA-2018-a068ade416  Critical   firefox-59.0.1-1.fc27.x86_64
       Upgraded: firefox 59.0-4.fc27 -&amp;gt; 59.0.1-1.fc27
                 osinfo-db 20170813-1.fc27 -&amp;gt; 20180311-1.fc27
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As shown in the output above, it also includes open security
advisories and their severities.&lt;/p&gt;

&lt;p&gt;This is only the start. The goal is to support fully
automated updates, including automatic reboots as well as a
&lt;q&gt;softer&lt;/q&gt; pending mode where new deployments are created, but
reboots are initiated manually.&lt;/p&gt;

&lt;p&gt;Upstream issue: &lt;a href="https://github.com/projectatomic/rpm-ostree/issues/247"&gt;https://github.com/projectatomic/rpm-ostree/issues/247&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;Overrides no longer experimental&lt;/h3&gt;

&lt;p&gt;We have now straightened out the &lt;code&gt;override&lt;/code&gt; commands enough
that we feel confident declaring it stable. For example, we
now support doing &lt;code&gt;override replace&lt;/code&gt; to replace the kernel
itself. As a result it has been moved out of &lt;code&gt;ex&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Upstream patch: &lt;a href="https://github.com/projectatomic/rpm-ostree/pull/1089"&gt;https://github.com/projectatomic/rpm-ostree/pull/1089&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;New kargs experimental feature&lt;/h3&gt;

&lt;p&gt;There is a new &lt;code&gt;kargs&lt;/code&gt; command to make it easier to modify
kernel arguments. The feature is marked experimental for
now, and thus is found under the &lt;code&gt;ex&lt;/code&gt; command. For more
information on &lt;code&gt;kargs&lt;/code&gt;, check out Peter&amp;rsquo;s blog post covering
it in details
&lt;a href="../../../2018/03/update-kernel-arguments-on-atomic-host/"&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Upstream patch: &lt;a href="https://github.com/projectatomic/rpm-ostree/pull/1013"&gt;https://github.com/projectatomic/rpm-ostree/pull/1013&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;New cancel command&lt;/h3&gt;

&lt;p&gt;rpm-ostree now supports a new &lt;code&gt;cancel&lt;/code&gt; command to cancel any
ongoing transaction. This is useful for cases where you lost
the controlling TTY from which you initiated the operation.&lt;/p&gt;

&lt;p&gt;More fundamentally, this is a classic display of the power
of the background update mechanism in Atomic Host. You can
safely cancel an update at any time without affecting the
stability of your running system.&lt;/p&gt;

&lt;p&gt;Upstream patch: &lt;a href="https://github.com/projectatomic/rpm-ostree/pull/1019"&gt;https://github.com/projectatomic/rpm-ostree/pull/1019&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;LiveFS support for full filesystem update&lt;/h3&gt;

&lt;p&gt;Previously, the experimental &lt;code&gt;livefs&lt;/code&gt; command only worked
when the pending deployment had pure additions (e.g. a new
layered package). &lt;code&gt;livefs&lt;/code&gt; now supports a &lt;code&gt;--replace&lt;/code&gt; switch
to take this to the extreme and switch all of &lt;code&gt;/usr&lt;/code&gt;. This
is essentially a big hammer, so use with care.&lt;/p&gt;

&lt;p&gt;As usual, please remember that details of the &lt;code&gt;livefs&lt;/code&gt;
command may change in a future release.&lt;/p&gt;

&lt;p&gt;Upstream patch: &lt;a href="https://github.com/projectatomic/rpm-ostree/pull/1028"&gt;https://github.com/projectatomic/rpm-ostree/pull/1028&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;Other minor fixes and improvements&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;The &lt;code&gt;upgrade&lt;/code&gt;, &lt;code&gt;deploy&lt;/code&gt;, and &lt;code&gt;rebase&lt;/code&gt; commands learned new
&lt;code&gt;--download-only&lt;/code&gt; and &lt;code&gt;--cache-only&lt;/code&gt; switches. This is
analogous to &lt;code&gt;dnf&lt;/code&gt;&amp;rsquo;s &lt;code&gt;--downloadonly&lt;/code&gt; and &lt;code&gt;--cacheonly&lt;/code&gt;
switches, but extends to layered packages as well.&lt;/li&gt;
&lt;li&gt;Related to the previous item, a new &lt;code&gt;refresh-md&lt;/code&gt; command
was added to support refreshing the rpm-md. This is
analogous to &lt;code&gt;dnf&lt;/code&gt;&amp;rsquo;s &lt;code&gt;makecache&lt;/code&gt; command.&lt;/li&gt;
&lt;li&gt;In the spirit of making rpm-ostree the only front-facing
application, a new &lt;code&gt;usroverlay&lt;/code&gt; command was added to take
over the functionality of &lt;code&gt;ostree admin unlock&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;compose tree&lt;/code&gt; subcommand has now been split into
three subcommands: &lt;code&gt;install&lt;/code&gt;, &lt;code&gt;postprocess&lt;/code&gt;, and &lt;code&gt;commit&lt;/code&gt;.
This can be used to more easily customize the rootfs
before committing it to the OSTree repo.&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;db diff&lt;/code&gt; command now can use commit metadata to
retrive package lists. This means that one no longer needs
to have the full commit when performing diffs.&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;status&lt;/code&gt; command learned a new &lt;code&gt;--booted&lt;/code&gt; switch to
only display information about the booted deployment.&lt;/li&gt;
&lt;/ul&gt;
</content>
  </entry>
  <entry>
    <title>rpm-ostree v2017.8 released</title>
    <link rel="alternate" href="http://www.projectatomic.io/blog/2017/09/rpm-ostree-v2017.8-released/"/>
    <id>http://www.projectatomic.io/blog/2017/09/rpm-ostree-v2017.8-released/</id>
    <published>2017-09-13T17:00:00+00:00</published>
    <updated>2021-10-07T14:03:16+00:00</updated>
    <author>
      <name>Jonathan Lebon</name>
    </author>
    <content type="html">&lt;p&gt;&lt;a href="https://rpm-ostree.readthedocs.org/"&gt;rpm-ostree&lt;/a&gt; is the
hybrid image/package system that provides transactional
upgrades on Atomic Host. Here are some highlights from
version
&lt;a href="https://github.com/projectatomic/rpm-ostree/releases/tag/v2017.8"&gt;v2017.8&lt;/a&gt;,
including better PolicyKit integration and support for RPM file triggers.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;You can test it out by rebasing to the
&lt;a href="http://www.projectatomic.io/blog/2017/09/fedora-atomic-26-120/"&gt;latest Fedora Atomic Host release&lt;/a&gt;
or &lt;a href="https://getfedora.org/en/atomic/download/"&gt;downloading it&lt;/a&gt;.&lt;/p&gt;

&lt;h3&gt;Better PolicyKit integration&lt;/h3&gt;

&lt;p&gt;In this release, we built upon the PolicyKit support added
in the previous release to allow authentication directly
from the terminal. This means that users can now run
rpm-ostree operations as non-root and only authenticate for
the operation requested instead of resorting to &lt;code&gt;sudo&lt;/code&gt;:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;[cloud-user@f26-tmp ~]$ rpm-ostree status
State: idle
Deployments:
* fedora-atomic:fedora/26/x86_64/atomic-host
                   Version: 26.120 (2017-09-05 00:05:09)
                    Commit: 0b0127864022dd6ffad1a183241fbd5482ef5a1642ff3c8751c2e6cae6070b1a
              GPGSignature: Valid signature by E641850B77DF435378D1D7E2812A6B4B64DAB85D
[cloud-user@f26-tmp ~]$ rpm-ostree install cowsay
==== AUTHENTICATING FOR org.projectatomic.rpmostree1.install-uninstall-packages ===
Authentication is required to install and remove software
Authenticating as: Fedora (cloud-user)
Password:
==== AUTHENTICATION COMPLETE ===
Checking out tree 0b01278... done
...

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Upstream patches: &lt;a href="https://github.com/projectatomic/rpm-ostree/pull/894"&gt;https://github.com/projectatomic/rpm-ostree/pull/894&lt;/a&gt;.&lt;/p&gt;

&lt;h3&gt;Support for RPM file triggers&lt;/h3&gt;

&lt;p&gt;When layering packages, rpm-ostree essentially re-implements
parts of the functionality of &lt;code&gt;rpm&lt;/code&gt;. For example, RPM
scriptlets are run in a locked down environment to ensure
minimal exposure. In this release, rpm-ostree added support
for running &lt;a href="http://rpm.org/user_doc/file_triggers.html"&gt;file trigger scriptlets&lt;/a&gt;.
This is necessary for successfully layering some packages,
such as &lt;code&gt;vagrant&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Upstream patches: &lt;a href="https://github.com/projectatomic/rpm-ostree/pull/869"&gt;https://github.com/projectatomic/rpm-ostree/pull/869&lt;/a&gt;.&lt;/p&gt;

&lt;h3&gt;Upgrade command also upgrades layered packages&lt;/h3&gt;

&lt;p&gt;Previously, the &lt;code&gt;upgrade&lt;/code&gt; command only layered a new
deployment if a new ostree commit was available, regardless
of whether new versions were available for layered packages.
This was fixed in this release so that &lt;code&gt;upgrade&lt;/code&gt; always
checks for outdated layered packages even if there are no
new commits.&lt;/p&gt;

&lt;p&gt;Upstream issue: &lt;a href="https://github.com/projectatomic/rpm-ostree/issues/391"&gt;https://github.com/projectatomic/rpm-ostree/issues/391&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;Better help output&lt;/h3&gt;

&lt;p&gt;For commands that take subcommands, the help output now
outputs a description of each subcommand. This is especially
useful on Atomic Host, where man pages are not readily
available.&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;[cloud-user@f26-tmp ~]$ rpm-ostree --help
Usage:
  rpm-ostree [OPTION?] COMMAND

Builtin Commands:
  compose          Commands to compose a tree
  cleanup          Clear cached/pending data
  db               Commands to query the RPM database
  deploy           Deploy a specific commit
  rebase           Switch to a different tree
  rollback         Revert to the previously booted tree
  status           Get the version of the booted system
  upgrade          Perform a system upgrade
  reload           Reload configuration
  initramfs        Enable or disable local initramfs regeneration
  install          Download and install layered RPM packages
  uninstall        Remove one or more overlay packages

Help Options:
  -h, --help       Show help options

Application Options:
  --version        Print version information and exit
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Upstream issue: &lt;a href="https://github.com/projectatomic/rpm-ostree/issues/806"&gt;https://github.com/projectatomic/rpm-ostree/issues/806&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;Other minor fixes and improvements&lt;/h3&gt;

&lt;p&gt;There are many other small improvements, here are a few:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;rpm-ostree learned about the &lt;code&gt;ostree.endoflife&lt;/code&gt; metadata
key, which displays an informative message when an OS
stream (branch) reaches end-of-life. This will likely be
used for Fedora Atomic Host.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Upstream patches: &lt;a href="https://github.com/projectatomic/rpm-ostree/pull/889"&gt;https://github.com/projectatomic/rpm-ostree/pull/889&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;rpm-ostree was submitted to
&lt;a href="https://scan.coverity.com/"&gt;Coverity&lt;/a&gt; and received many
fixes detected in the scan. No major issues were
uncovered.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Upstream patches: &lt;a href="https://github.com/projectatomic/rpm-ostree/pull/918"&gt;https://github.com/projectatomic/rpm-ostree/pull/918&lt;/a&gt;&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>rpm-ostree v2017.7 released</title>
    <link rel="alternate" href="http://www.projectatomic.io/blog/2017/07/rpm-ostree-v2017.7-released/"/>
    <id>http://www.projectatomic.io/blog/2017/07/rpm-ostree-v2017.7-released/</id>
    <published>2017-07-25T14:00:00+00:00</published>
    <updated>2021-10-07T14:03:16+00:00</updated>
    <author>
      <name>Jonathan Lebon</name>
    </author>
    <content type="html">&lt;p&gt;&lt;a href="https://rpm-ostree.readthedocs.org/"&gt;rpm-ostree&lt;/a&gt; is the
hybrid image/package system that provides transactional
upgrades on Atomic Host. Here are some highlights from
version
&lt;a href="https://github.com/projectatomic/rpm-ostree/releases/tag/v2017.7"&gt;v2017.7&lt;/a&gt;,
including PolicyKit and experimental overrides support.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;As usual, you can test out this release by
&lt;a href="https://fedoraproject.org/wiki/QA:Updates_Testing#Using_it_with_Atomic_Host_.28Fedora_24_and_later.29"&gt;rebasing your Fedora Atomic Host&lt;/a&gt;
onto the testing branch. Feel free to also leave karma in
the pending Bodhi updates:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://bodhi.fedoraproject.org/updates/FEDORA-2017-45adcbb9a3"&gt;Fedora 25 update&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://bodhi.fedoraproject.org/updates/FEDORA-2017-483c7979ee"&gt;Fedora 26 update&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Note that this is the final release of rpm-ostree on Fedora
25 as we focus our efforts on Fedora 26.&lt;/p&gt;

&lt;h3&gt;Experimental support for overrides&lt;/h3&gt;

&lt;p&gt;The most visible change in this release is the addition of a
new &lt;code&gt;ex&lt;/code&gt; subcommand: &lt;code&gt;rpm-ostree ex override&lt;/code&gt; (the &lt;code&gt;ex&lt;/code&gt;
command groups new features that are not ready to be
declared stable; details of how these commands work may
change in the future).&lt;/p&gt;

&lt;p&gt;Whereas the &lt;code&gt;install&lt;/code&gt; command allows you to overlay packages
on top of the base commit received from your content
provider, the &lt;code&gt;override&lt;/code&gt; command allows you to modify the
set of packages in the base commit itself. For example, you
may want to remove a package that conflicts with an overlay,
or more interestingly, update a package to a newer version
to fix a bug.&lt;/p&gt;

&lt;p&gt;Of course, such modifications should be done with care,
since they in effect &lt;q&gt;void&lt;/q&gt; the warranty implied by an
ostree commit. However, these powerful semantics enable us
to take the image/package hybrid paradigm to a new level.
Thanks to rpm-ostree, you can easily keep track of every
deviation from the base image.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;override&lt;/code&gt; command supports two subcommands: &lt;code&gt;remove&lt;/code&gt;
and &lt;code&gt;replace&lt;/code&gt;.&lt;/p&gt;

&lt;h3&gt;Removal overrides&lt;/h3&gt;

&lt;p&gt;Not surprisingly, the &lt;code&gt;remove&lt;/code&gt; subcommand allows you remove
a base package. Let&amp;rsquo;s see it in action!&lt;/p&gt;

&lt;p&gt;The host below has &lt;code&gt;strace&lt;/code&gt; installed and no packages
layered:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm-ostree status
State: idle
Deployments:
* fedora-atomic:fedora/26/x86_64/testing/atomic-host
                   Version: 26.91 (2017-07-23 09:39:09)
                    Commit: d2ef5e5b1e3803a9e79ecf6a005e6ad80d3b69632b7f3ee7fcb6a46174a9bbf3
              GPGSignature: Valid signature by E641850B77DF435378D1D7E2812A6B4B64DAB85D

# rpm -q strace
strace-4.18-1.fc26.x86_64
# strace -V
strace -- version 4.18
Copyright (c) 1991-2017 The strace developers &amp;lt;https://strace.io&amp;gt;.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Let&amp;rsquo;s now add an override to remove &lt;code&gt;strace&lt;/code&gt;:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm-ostree ex override remove strace
Checking out tree 20431e5... done
Enabled rpm-md repositories: updates fedora
rpm-md repo 'updates' (cached); generated: 2017-07-23 22:35:15
rpm-md repo 'fedora' (cached); generated: 2016-11-15 19:49:18

Importing metadata [===========================================] 100%
Resolving dependencies... done
Applying 1 override... done
Writing rpmdb... done
Writing OSTree commit... done
Copying /etc changes: 25 modified, 0 removed, 628 added
Transaction complete; bootconfig swap: yes deployment count change: 1
Removed:
  strace-4.18-1.fc26.x86_64
Run "systemctl reboot" to start a reboot
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Let&amp;rsquo;s confirm that &lt;code&gt;strace&lt;/code&gt; is truly gone:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# reboot
...
# rpm-ostree status
State: idle
Deployments:
* fedora-atomic:fedora/26/x86_64/testing/atomic-host
                   Version: 26.91 (2017-07-23 09:39:09)
                BaseCommit: d2ef5e5b1e3803a9e79ecf6a005e6ad80d3b69632b7f3ee7fcb6a46174a9bbf3
              GPGSignature: Valid signature by E641850B77DF435378D1D7E2812A6B4B64DAB85D
       RemovedBasePackages: strace-4.18-1.fc26.x86_64

  fedora-atomic:fedora/26/x86_64/testing/atomic-host
                   Version: 26.91 (2017-07-23 09:39:09)
                    Commit: d2ef5e5b1e3803a9e79ecf6a005e6ad80d3b69632b7f3ee7fcb6a46174a9bbf3
              GPGSignature: Valid signature by E641850B77DF435378D1D7E2812A6B4B64DAB85D
# rpm -q strace
package strace is not installed
# strace -V
bash: strace: command not found
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We can remove the override by using the &lt;code&gt;reset&lt;/code&gt; command:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm-ostree ex override reset strace
Copying /etc changes: 25 modified, 0 removed, 630 added
Transaction complete; bootconfig swap: no deployment count change: 0
Added:
  strace-4.18-1.fc26.x86_64
Run "systemctl reboot" to start a reboot
# rpm-ostree status
State: idle
Deployments:
  fedora-atomic:fedora/26/x86_64/testing/atomic-host
                   Version: 26.91 (2017-07-23 09:39:09)
                    Commit: d2ef5e5b1e3803a9e79ecf6a005e6ad80d3b69632b7f3ee7fcb6a46174a9bbf3
              GPGSignature: Valid signature by E641850B77DF435378D1D7E2812A6B4B64DAB85D

* fedora-atomic:fedora/26/x86_64/testing/atomic-host
                   Version: 26.91 (2017-07-23 09:39:09)
                BaseCommit: d2ef5e5b1e3803a9e79ecf6a005e6ad80d3b69632b7f3ee7fcb6a46174a9bbf3
              GPGSignature: Valid signature by E641850B77DF435378D1D7E2812A6B4B64DAB85D
       RemovedBasePackages: strace-4.18-1.fc26.x86_64
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;Replacement overrides&lt;/h3&gt;

&lt;p&gt;Similarly, the &lt;code&gt;replace&lt;/code&gt; subcommand allows you to replace a
base package with a different version. For now, you can only
replace packages using local RPMs.&lt;/p&gt;

&lt;p&gt;In this example, instead of removing &lt;code&gt;strace&lt;/code&gt;, we will
upgrade it. On this machine, I&amp;rsquo;ve got v4.17 installed:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm -q strace
strace-4.17-1.fc26.x86_64
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I&amp;rsquo;ve also got the build for the next version, v4.18, handy:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# ls -l strace-*.rpm
-rw-r--r--. 1 root root 659434 Jul 24 16:58 strace-4.18-1.fc26.x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And now, we can add an override to replace &lt;code&gt;strace&lt;/code&gt;:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm-ostree ex override replace strace-4.18-1.fc26.x86_64.rpm
Checking out tree 6f3c6a2... done
Enabled rpm-md repositories: updates fedora
rpm-md repo 'updates' (cached); generated: 2017-07-23 22:35:15
rpm-md repo 'fedora' (cached); generated: 2016-11-15 19:49:18

Importing metadata [===========================================] 100%
Resolving dependencies... done
Applying 1 override... done
Writing rpmdb... done
Writing OSTree commit... done
Copying /etc changes: 25 modified, 0 removed, 636 added
Transaction complete; bootconfig swap: yes deployment count change: 1
Upgraded:
  strace 4.17-1.fc26 -&amp;gt; 4.18-1.fc26
Run "systemctl reboot" to start a reboot
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And finally, let&amp;rsquo;s reboot to check that it worked:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# reboot
...
# rpm-ostree status
State: idle
Deployments:
* fedora-atomic:fedora/26/x86_64/testing/atomic-host
                   Version: 26.91 (2017-07-23 09:39:09)
                BaseCommit: d2ef5e5b1e3803a9e79ecf6a005e6ad80d3b69632b7f3ee7fcb6a46174a9bbf3
              GPGSignature: Valid signature by E641850B77DF435378D1D7E2812A6B4B64DAB85D
      ReplacedBasePackages: strace 4.17-1.fc26 -&amp;gt; 4.18-1.fc26

  fedora-atomic:fedora/26/x86_64/testing/atomic-host
                   Version: 26.91 (2017-07-23 09:39:09)
                    Commit: d2ef5e5b1e3803a9e79ecf6a005e6ad80d3b69632b7f3ee7fcb6a46174a9bbf3
              GPGSignature: Valid signature by E641850B77DF435378D1D7E2812A6B4B64DAB85D
[root@f25-ros-dev2 ~]# rpm -q strace
strace-4.18-1.fc26.x86_64
[root@f25-ros-dev2 ~]# strace -V | grep version
strace -- version 4.18
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Of course, this can be used for more meaningful packages as
well, like &lt;code&gt;docker&lt;/code&gt; and &lt;code&gt;kubernetes&lt;/code&gt;. For example, here I&amp;rsquo;m
updating &lt;code&gt;kubernetes&lt;/code&gt; to the latest build I could find in
Koji (with complete disregard to matching the distro):&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm -q kubernetes
kubernetes-1.5.3-1.fc26.x86_64
# kube-apiserver --version
Kubernetes v1.5.3
# # ls -l kubernetes-*.rpm
-rw-r--r--. 1 root root    43446 Jul 24 17:12 kubernetes-1.7.1-1.fc27.x86_64.rpm
-rw-r--r--. 1 root root 22750546 Jul 24 17:54 kubernetes-client-1.7.1-1.fc27.x86_64.rpm
-rw-r--r--. 1 root root 39959790 Jul 24 17:13 kubernetes-master-1.7.1-1.fc27.x86_64.rpm
-rw-r--r--. 1 root root 22432058 Jul 24 17:55 kubernetes-node-1.7.1-1.fc27.x86_64.rpm
# rpm-ostree ex override replace kubernetes-*.rpm
...
Upgraded:
  kubernetes 1.5.3-1.fc26 -&amp;gt; 1.7.1-1.fc27
  kubernetes-client 1.5.3-1.fc26 -&amp;gt; 1.7.1-1.fc27
  kubernetes-master 1.5.3-1.fc26 -&amp;gt; 1.7.1-1.fc27
  kubernetes-node 1.5.3-1.fc26 -&amp;gt; 1.7.1-1.fc27
Run "systemctl reboot" to start a reboot
# reboot
...
# rpm-ostree status
State: idle
Deployments:
* fedora-atomic:fedora/26/x86_64/testing/atomic-host
                   Version: 26.91 (2017-07-23 09:39:09)
                BaseCommit: d2ef5e5b1e3803a9e79ecf6a005e6ad80d3b69632b7f3ee7fcb6a46174a9bbf3
              GPGSignature: Valid signature by E641850B77DF435378D1D7E2812A6B4B64DAB85D
      ReplacedBasePackages: kubernetes-client 1.5.3-1.fc26 -&amp;gt; 1.7.1-1.fc27, kubernetes 1.5.3-1.fc26 -&amp;gt; 1.7.1-1.fc27, kubernetes-node 1.5.3-1.fc26 -&amp;gt; 1.7.1-1.fc27, kubernetes-master 1.5.3-1.fc26 -&amp;gt; 1.7.1-1.fc27

  fedora-atomic:fedora/26/x86_64/testing/atomic-host
                   Version: 26.91 (2017-07-23 09:39:09)
                    Commit: d2ef5e5b1e3803a9e79ecf6a005e6ad80d3b69632b7f3ee7fcb6a46174a9bbf3
              GPGSignature: Valid signature by E641850B77DF435378D1D7E2812A6B4B64DAB85D
# rpm -q kubernetes
kubernetes-1.7.1-1.fc27.x86_64
# kube-apiserver --version
Kubernetes v1.7.1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We&amp;rsquo;ll look to cleaning up the status output in the future in
cases where multiple related subpackages are updated.&lt;/p&gt;

&lt;h3&gt;PolicyKit support for D-Bus API&lt;/h3&gt;

&lt;p&gt;rpm-ostree now ships with a polkit policy. This is primarily
motivated by work underway to support rpm-ostree in GNOME
Software, though it&amp;rsquo;s useful in the server case as well.
It is currently visible only at the D-Bus API level; for
now, the rpm-ostree CLI tool still needs to be run as root
for most operations. In the future, users will be able to
authenticate directly from the terminal and thus avoid
having to use &lt;code&gt;sudo&lt;/code&gt; completely.&lt;/p&gt;

&lt;h3&gt;Other minor fixes and improvements&lt;/h3&gt;

&lt;p&gt;There are many other small improvements, here are a few:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;rpm-ostree now logs even more information to the journal.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;rpm-ostree now shows GPG signatures only in the output of
&lt;code&gt;status&lt;/code&gt; and does so in a less verbose way.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Instead of this output:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;  GPGSignature: 1 signature
                Signature made Fri Jul  7 13:19:06 2017 using RSA key ID 812A6B4B64DAB85D
                Good signature from "Fedora 26 Primary &amp;lt;fedora-26-primary@fedoraproject.org&amp;gt;"
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;rpm-ostree now prints this:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;  GPGSignature: Valid signature by E641850B77DF435378D1D7E2812A6B4B64DAB85D
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As usual, you can see the full list of changes in the
&lt;a href="https://github.com/projectatomic/rpm-ostree/releases/tag/v2017.7"&gt;release notes&lt;/a&gt;.&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>rpm-ostree v2017.6 released</title>
    <link rel="alternate" href="http://www.projectatomic.io/blog/2017/06/rpm-ostree-v2017.6-released/"/>
    <id>http://www.projectatomic.io/blog/2017/06/rpm-ostree-v2017.6-released/</id>
    <published>2017-06-05T14:00:00+00:00</published>
    <updated>2021-10-07T14:03:16+00:00</updated>
    <author>
      <name>Jonathan Lebon</name>
    </author>
    <content type="html">&lt;p&gt;&lt;a href="https://rpm-ostree.readthedocs.org/"&gt;rpm-ostree&lt;/a&gt; is the
hybrid image/package system that provides transactional
upgrades on Atomic Host. Here are some highlights from
version
&lt;a href="https://github.com/projectatomic/rpm-ostree/releases/tag/v2017.6"&gt;v2017.6&lt;/a&gt;, including
&amp;ldquo;livefs&amp;rdquo; support for adding package layers.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;The highlight of this release is experimental support for
live system updates. You can test it out by
&lt;a href="https://fedoraproject.org/wiki/QA:Updates_Testing#Using_it_with_Atomic_Host_.28Fedora_24_and_later.29"&gt;rebasing your Fedora Atomic Host&lt;/a&gt;
onto the testing branch. Feel free to also leave karma in
the pending Bodhi updates:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://bodhi.fedoraproject.org/updates/FEDORA-2017-85014ae3f6"&gt;Fedora 25 update&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://bodhi.fedoraproject.org/updates/FEDORA-2017-f86a299577"&gt;Fedora 26 update&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Live updates&lt;/h3&gt;

&lt;p&gt;rpm-ostree now has experimental support for applying some
updates live without the need to reboot using the
&lt;code&gt;rpm-ostree ex livefs&lt;/code&gt; command (the &lt;code&gt;ex&lt;/code&gt; command groups new
features that are not ready to be declared stable; details
of how these commands work may change in the future).&lt;/p&gt;

&lt;p&gt;For now, the &lt;code&gt;livefs&lt;/code&gt; command only works in situations where
the only difference between the pending deployment and the
current deployment is added packages. You can see it in
action below:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm-ostree status
State: idle
Deployments:
* vmcheck
              Timestamp: 2017-06-02 19:45:32
                 Commit: 3f5650aeffe16474584b57c6ec0654e6fd96c3c60d998a04b1e550e61556d8ab
# ltrace
bash: ltrace: command not found
# rpm -q ltrace
package ltrace is not installed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We don&amp;rsquo;t have ltrace installed. Let&amp;rsquo;s overlay it:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm-ostree install ltrace
Checking out tree 3f5650a... done
Enabled rpm-md repositories: fedora-cisco-openh264 updates fedora jlebon
rpm-md repo 'fedora-cisco-openh264' (cached); generated: 2017-03-24 17:58:10
rpm-md repo 'updates' (cached); generated: 2017-06-02 01:51:29
rpm-md repo 'fedora' (cached); generated: 2016-11-15 19:49:18
rpm-md repo 'jlebon' (cached); generated: 2017-05-08 16:24:16

Importing metadata [========================================================100%
Resolving dependencies... done
Will download: 1 package (159.2 kB)

  Downloading from fedora: [================================================100%

Importing: [================================================================100%
Overlaying... done
Writing rpmdb... done
Writing OSTree commit... done
Copying /etc changes: 26 modified, 0 removed, 103 added
Transaction complete; bootconfig swap: yes deployment count change: 1
Added:
  ltrace-0.7.91-20.fc25.x86_64
Run "systemctl reboot" to start a reboot
# rpm-ostree status
State: idle
Deployments:
  vmcheck
              Timestamp: 2017-06-02 19:45:32
             BaseCommit: 3f5650aeffe16474584b57c6ec0654e6fd96c3c60d998a04b1e550e61556d8ab
        LayeredPackages: ltrace

* vmcheck
              Timestamp: 2017-06-02 19:45:32
                 Commit: 3f5650aeffe16474584b57c6ec0654e6fd96c3c60d998a04b1e550e61556d8ab
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Normally, at this point, we&amp;rsquo;d have to reboot. However, since
we just added a package, we can use the &lt;code&gt;livefs&lt;/code&gt; command
instead to get the changes immediately applied:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm-ostree ex livefs
notice: "livefs" is an experimental command and subject to change.
Diff Analysis: 3f5650aeffe16474584b57c6ec0654e6fd96c3c60d998a04b1e550e61556d8ab =&amp;gt; f71fedccd227b5112b461b466106e069bf2c1c2de21f1554abda72297594e8a0
Files:
 modified: 0
 removed: 0
 added: 15
Packages:
 modified: 0
 removed: 0
 added: 1
Preparing new rollback matching currently booted deployment
Copying /etc changes: 26 modified, 0 removed, 103 added
Transaction complete; bootconfig swap: yes deployment count change: 1
Overlaying /usr... done
# ltrace
ltrace: too few arguments
Try `ltrace --help' for more information.
# rpm -q ltrace
ltrace-0.7.91-20.fc25.x86_64
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;livefs&lt;/code&gt; command helpfully created a rollback deployment
of the original commit we booted into because it modifies
the deployment itself permanently. You can see this
modification reflected in the output of the &lt;code&gt;status&lt;/code&gt;
command:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm-ostree status
State: idle
Deployments:
  vmcheck
              Timestamp: 2017-06-02 19:45:32
             BaseCommit: 3f5650aeffe16474584b57c6ec0654e6fd96c3c60d998a04b1e550e61556d8ab
                 Commit: f71fedccd227b5112b461b466106e069bf2c1c2de21f1554abda72297594e8a0
        LayeredPackages: ltrace

* vmcheck
              Timestamp: 2017-06-02 19:45:32
           BootedCommit: 3f5650aeffe16474584b57c6ec0654e6fd96c3c60d998a04b1e550e61556d8ab
             LiveCommit: f71fedccd227b5112b461b466106e069bf2c1c2de21f1554abda72297594e8a0

  vmcheck
              Timestamp: 2017-06-02 19:45:32
                 Commit: 3f5650aeffe16474584b57c6ec0654e6fd96c3c60d998a04b1e550e61556d8ab
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;BootedCommit&lt;/code&gt; is the commit we original started with,
whereas the &lt;code&gt;LiveCommit&lt;/code&gt; is the commit that was applied to
the live deployment.&lt;/p&gt;

&lt;p&gt;As mentioned earlier, this feature is still in experimental
mode, and thus is subject to change. Discussions are still
ongoing upstream as to the finer details of the command and
expected use cases.&lt;/p&gt;

&lt;h3&gt;Repodata caching&lt;/h3&gt;

&lt;p&gt;You might have noticed this bit in the output above:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;Enabled rpm-md repositories: fedora-cisco-openh264 updates fedora jlebon
rpm-md repo 'fedora-cisco-openh264' (cached); generated: 2017-03-24 17:58:10
rpm-md repo 'updates' (cached); generated: 2017-06-02 01:51:29
rpm-md repo 'fedora' (cached); generated: 2016-11-15 19:49:18
rpm-md repo 'jlebon' (cached); generated: 2017-05-08 16:24:16
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;rpm-ostree now caches repo metadata for up to a day, and
prints this information during layering operations. One can
do &lt;code&gt;cleanup -m&lt;/code&gt; in order to purge the metadata and force a
refresh.&lt;/p&gt;

&lt;h3&gt;Journal logging&lt;/h3&gt;

&lt;p&gt;The rpm-ostree daemon now logs more and more information to
the journal to help sysadmins understand system state and to
diagnose issues. Here are some sample journal outputs from
the operations above:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;rpm-ostree[1276]: Preparing pkg txn; enabled repos: ['updates', 'fedora', 'jlebon'] solvables: 71435
rpm-ostree[1276]: Imported 1 pkg
...
rpm-ostree[1276]: Starting livefs for commit f71fedccd227b5112b461b466106e069bf2c1c2de21f1554abda72297594e8a0 addition; 1 pkgs, 15 files
rpm-ostree[1276]: Completed livefs for commit f71fedccd227b5112b461b466106e069bf2c1c2de21f1554abda72297594e8a0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Many of these journal entries actually use the structured
output feature of journald. For example, there is a
dedicated
&lt;a href="https://www.freedesktop.org/software/systemd/man/systemd.journal-fields.html"&gt;MESSAGE_ID&lt;/a&gt;
for reporting repo information during package transactions:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# journalctl -b 0 MESSAGE_ID=0eea679bbfa34d43802dec99b274ebe7 -o json-pretty
{
        ...
        "MESSAGE_ID" : "0eea679bbfa34d43802dec99b274ebe7",
        "MESSAGE" : "Preparing pkg txn; enabled repos: ['updates', 'fedora', 'jlebon'] solvables: 71435",
        "SACK_N_SOLVABLES" : "71881",
        "ENABLED_REPOS" : "['updates', 'fedora', 'jlebon']",
        "ENABLED_REPOS_SOLVABLES" : "[19748, 51669, 18]",
        "ENABLED_REPOS_TIMESTAMPS" : "[1496368289, 1479239358, 1494260656]",
        ...
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;Other minor fixes and improvements&lt;/h3&gt;

&lt;p&gt;There are many other small improvements, here are a few:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;rpm-ostree is now more diligent about checking whether
RPMs from repos are the same as locally cached RPMs.
Previously, two different RPMs with the same name and
version would be considered equivalent. We now store the
actual package checksum and do a comparison to verify
this.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;on the compose side, rpm-ostree now supports a new
&lt;code&gt;tmp-is-dir&lt;/code&gt; field, which allows for example, systemd to
mount a tmpfs on startup, rather than using a central
permanent &lt;code&gt;/tmp&lt;/code&gt; directory.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;rpm-ostree is now capable of rebasing to a local branch
using the &lt;code&gt;rebase :local-branch&lt;/code&gt; syntax. This was
previously not possible if the current refspec was from a
remote.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
  </entry>
  <entry>
    <title>rpm-ostree v2017.5 released</title>
    <link rel="alternate" href="http://www.projectatomic.io/blog/2017/04/rpm-ostree-v2017.5-released/"/>
    <id>http://www.projectatomic.io/blog/2017/04/rpm-ostree-v2017.5-released/</id>
    <published>2017-04-29T18:00:00+00:00</published>
    <updated>2021-10-07T14:03:16+00:00</updated>
    <author>
      <name>Jonathan Lebon</name>
    </author>
    <content type="html">&lt;p&gt;&lt;a href="https://rpm-ostree.readthedocs.org/"&gt;rpm-ostree&lt;/a&gt; is the
hybrid image/package system that provides transactional
upgrades on Atomic Host. Here are some highlights from
version
&lt;a href="https://github.com/projectatomic/rpm-ostree/releases/tag/v2017.5"&gt;v2017.5&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;This is a short release with mostly bugfixes, though there
are some small visible changes. You can test it out by
&lt;a href="https://fedoraproject.org/wiki/QA:Updates_Testing#Using_it_with_Atomic_Host_.28Fedora_24_and_later.29"&gt;rebasing your Fedora Atomic Host&lt;/a&gt;
onto the testing branch. Feel free to also leave karma in
the pending Bodhi updates:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://bodhi.fedoraproject.org/updates/FEDORA-2017-2fa9ff86ba"&gt;Fedora 25 update&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://bodhi.fedoraproject.org/updates/FEDORA-2017-c5b64407b6"&gt;Fedora 26 update&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;More terse status output by default&lt;/h3&gt;

&lt;p&gt;In v2017.4, we slightly changed the output of the &lt;code&gt;status&lt;/code&gt;
command so that the &lt;code&gt;Commit&lt;/code&gt; line was hidden when packages
are layered:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm-ostree status
State: idle
Deployments:
* fedora-atomic:fedora-atomic/25/x86_64/docker-host
             Version: 25.113 (2017-04-25 01:47:29)
          BaseCommit: 3492546bc1ef6bca1bc7801ed6bb0414f90cc96668e067996dba3dee0d83e6c3
              OSName: fedora-atomic
     LayeredPackages: ltrace
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The rationale is that the &lt;code&gt;Commit&lt;/code&gt; line in this context is
specific to this host and has much less value than the
&lt;code&gt;BaseCommit&lt;/code&gt;, which is the actual ostree commit published by
Fedora.&lt;/p&gt;

&lt;p&gt;In v2017.5, the &lt;code&gt;OSName&lt;/code&gt; line is also no longer printed by
default. Essentially, for the great majority of Atomic Host
users, it is superfluous information. You can read more
about this change
&lt;a href="https://github.com/projectatomic/rpm-ostree/pull/743"&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;However, the &lt;code&gt;status&lt;/code&gt; command did learn a &lt;code&gt;--verbose&lt;/code&gt; switch
to force it to print both the &lt;code&gt;Commit&lt;/code&gt; and the &lt;code&gt;OSName&lt;/code&gt;
(which was renamed to &lt;code&gt;StateRoot&lt;/code&gt;):&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;# rpm-ostree status
State: idle
Deployments:
* jlebon:fedora-atomic/25/x86_64/docker-host
             Version: 25.113.modified (2017-04-25 01:47:29)
          BaseCommit: 3492546bc1ef6bca1bc7801ed6bb0414f90cc96668e067996dba3dee0d83e6c3
     LayeredPackages: ltrace
# rpm-ostree status --verbose
State: idle
Deployments:
* jlebon:fedora-atomic/25/x86_64/docker-host
             Version: 25.113.modified (2017-04-25 01:47:29)
          BaseCommit: 3492546bc1ef6bca1bc7801ed6bb0414f90cc96668e067996dba3dee0d83e6c3
              Commit: 4a926bfaa84b3307577b2ef6673cf2079f7373ebe2219cd7c2e30d75e7a2584b
           StateRoot: fedora-atomic
     LayeredPackages: ltrace
&lt;/code&gt;&lt;/pre&gt;
</content>
  </entry>
</feed>
